<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Thu Jun 27 23:30:50 CEST 2024 -->
<title>GameController</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2024-06-27">
<meta name="description" content="declaration: package: it.polimi.ingsw.controller, class: GameController">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">it.polimi.ingsw.controller</a></div>
<h1 title="Class GameController" class="title">Class GameController</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">it.polimi.ingsw.controller.GameController</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="Interfaces/GameControllerInterface.html" title="interface in it.polimi.ingsw.controller.Interfaces">GameControllerInterface</a></code>, <code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/Serializable.html" title="class or interface in java.io" class="external-link">Serializable</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">GameController</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>
implements <a href="Interfaces/GameControllerInterface.html" title="interface in it.polimi.ingsw.controller.Interfaces">GameControllerInterface</a></span></div>
<div class="block">This class is the controller of the game, it manages the game state and the players' actions
 It is responsible for the game turns logic and the communication between the model and players,
 and the communication between the model and the persistence layer</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="../../../../serialized-form.html#it.polimi.ingsw.controller.GameController">Serialized Form</a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(it.polimi.ingsw.model.tableReleted.Game,it.polimi.ingsw.model.cardReleted.cards.CardTable,it.polimi.ingsw.controller.persistence.PersistenceFactory,it.polimi.ingsw.controller.Interfaces.GameList,it.polimi.ingsw.controller.Interfaces.MalevolentPlayerManager)" class="member-name-link">GameController</a><wbr>(<a href="../model/tableReleted/Game.html" title="class in it.polimi.ingsw.model.tableReleted">Game</a>&nbsp;game,
 <a href="../model/cardReleted/cards/CardTable.html" title="class in it.polimi.ingsw.model.cardReleted.cards">CardTable</a>&nbsp;cardTable,
 <a href="persistence/PersistenceFactory.html" title="class in it.polimi.ingsw.controller.persistence">PersistenceFactory</a>&nbsp;persistenceFactory,
 <a href="Interfaces/GameList.html" title="interface in it.polimi.ingsw.controller.Interfaces">GameList</a>&nbsp;gameList,
 <a href="Interfaces/MalevolentPlayerManager.html" title="interface in it.polimi.ingsw.controller.Interfaces">MalevolentPlayerManager</a>&nbsp;malevolentPlayerManager)</code></div>
<div class="col-last even-row-color">
<div class="block">The constructor of the class GameController creates a new GameController object</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#choosePawn(java.lang.String,it.polimi.ingsw.model.playerReleted.PawnColors)" class="member-name-link">choosePawn</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname,
 <a href="../model/playerReleted/PawnColors.html" title="enum class in it.polimi.ingsw.model.playerReleted">PawnColors</a>&nbsp;color)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used by the user to choose its pawn color
 If the chosen color is not available, the player is notified and the prompted to re-choose a color
 If the player is not in the correct state to choose a pawn,
 the player the malevolent consequences are triggered
 If the player chooses the black pawn, the player is marked as malevolent
 Otherwise the model is updated with the chosen color, the player is moved to the wait state,
 waiting for the other players to choose their pawn and game is saved on disk
 Logs the event on the server
 The chooser view and the other players are notified of the choice
 If all the players have chosen their pawn, the game moves to the secret objective phase</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#chooseSecretObjective(java.lang.String,it.polimi.ingsw.lightModel.lightPlayerRelated.LightCard)" class="member-name-link">chooseSecretObjective</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname,
 <a href="../lightModel/lightPlayerRelated/LightCard.html" title="class in it.polimi.ingsw.lightModel.lightPlayerRelated">LightCard</a>&nbsp;lightObjChoice)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used to choose the secret objective card of the player
 If the chosen card is not valid or the player isn't in the correct state,
 the player is marked as malevolent
 Otherwise the model is updated with the chosen card, the player is moved to the wait state,
 the player choosing it is notified of the choice and its view updated,
 and the other players are notified of the choice
 If all the players have chosen their secret objective,
 the game moves to the actual game phase and the game is saved on disk
 Logs the event on the server</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#draw(java.lang.String,it.polimi.ingsw.model.cardReleted.utilityEnums.DrawableCard,int)" class="member-name-link">draw</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname,
 <a href="../model/cardReleted/utilityEnums/DrawableCard.html" title="enum class in it.polimi.ingsw.model.cardReleted.utilityEnums">DrawableCard</a>&nbsp;deckType,
 int&nbsp;cardID)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used to draw a card from the specified deck in the specified position
 If the player isn't in the correct state to draw the card, the player is marked as malevolent
 If deck are not empty and the card is drawn, the model is updated with the drawn card,
 and the view is updated accordingly with the drawn card in hand and the decks
 After the draw the game moves on to the next player turn,
 it checks if the ending conditions are met and if so moves to the last turns phase
 It save the game state on disk
 Logs the event on the server</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getGamePlayers()" class="member-name-link">getGamePlayers</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used to get the list of nicknames of the players that are part of the game,
 i.e.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="../view/ViewInterface.html" title="interface in it.polimi.ingsw.view">ViewInterface</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getPlayerViewMap()" class="member-name-link">getPlayerViewMap</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used to get the active players map containing
 their nicknames and the corresponding view objects</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getWinners()" class="member-name-link">getWinners</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">It calculates the player(s) with the max amount of points,
 if there is only one player with the max amount of points it declares it as the winner,
 otherwise it calculates the number of objective cards completed by the player(s) with the max amount of points
 if there is only one player with the max amount of objective cards completed it declares it as the winner,
 otherwise it declares all the players with the max amount of points and objective cards completed as the winners</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#join(java.lang.String,it.polimi.ingsw.view.ViewInterface,boolean)" class="member-name-link">join</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;joinerNickname,
 <a href="../view/ViewInterface.html" title="interface in it.polimi.ingsw.view">ViewInterface</a>&nbsp;view,
 boolean&nbsp;reconnected)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used to join the game managed by this controller
 if the player joining is no more part of the game, the player is moved to the login form
 else it logs the join event on the server, saves the game state, updates the model,
 updates the view of the joining player with the data corresponding with the current phase
 of the game, and notifies the other players of the join event
 If the player joining is the only player in the game, it starts the last player in game timer
 Logs the event on the server</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#leave(java.lang.String)" class="member-name-link">leave</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used by the player to leave the game managed by this controller
 The player is removed from the active players map, and the leave is notified to the other players views
 The view of the leaver is erased
 If the player is leaving while the game is in setup (choose start card, choose pawn, choose secret objective),
 the player leaving hasn't chosen yet while the other players have, the game moves on to the next phase
 If the player is leaving during its turn the game turns moves on,
 if the player should draw a card, the card is randomly drawn and the game moves on to the next player turn
 If after the player leaves it remains only one player in the game, the last player in game timer is started
 If the game is in the end game phase and the last player leaves, the game is deleted from the game list and from disk
 If all the players leaves while the game isn't in the end game phase,
 the game is saved and stored until reconnection or expiration defined by the gameSaveExpirationTimeMinutes</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#place(java.lang.String,it.polimi.ingsw.lightModel.lightPlayerRelated.LightPlacement)" class="member-name-link">place</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname,
 <a href="../lightModel/lightPlayerRelated/LightPlacement.html" title="class in it.polimi.ingsw.lightModel.lightPlayerRelated">LightPlacement</a>&nbsp;placement)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used to place the start card or the other card in hand by the player
 If the card placed is not valid or its position isn't in the frontier the player is marked as malevolent
 Otherwise it recognizes if the card placed is the start card or another card in hand and calls
 the corresponding method to place the card
 Logs the event on the server</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#sendChatMessage(it.polimi.ingsw.model.playerReleted.ChatMessage)" class="member-name-link">sendChatMessage</a><wbr>(<a href="../model/playerReleted/ChatMessage.html" title="class in it.polimi.ingsw.model.playerReleted">ChatMessage</a>&nbsp;chatMessage)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used to send a chat message to the game
 checks if the message is empty, if the receiver is empty or not in the game
 if not it sends the message to the receiver
 updating all the players lightChat if the message is public
 or only the sender and the receiver lightChat if the message is private</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#updateJoinActualGame(java.lang.String,it.polimi.ingsw.model.tableReleted.Game)" class="member-name-link">updateJoinActualGame</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;joiner,
 <a href="../model/tableReleted/Game.html" title="class in it.polimi.ingsw.model.tableReleted">Game</a>&nbsp;game)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Method used to update the lightModel of the user joining during the actualGame phase
 with the data of the game
 The active and inactive players are updated, the placement history is updated,
 the hand of the player is updated, the back of the hand of the other players is updated,
 the deck status is updated and the current player turn is updated</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(it.polimi.ingsw.model.tableReleted.Game,it.polimi.ingsw.model.cardReleted.cards.CardTable,it.polimi.ingsw.controller.persistence.PersistenceFactory,it.polimi.ingsw.controller.Interfaces.GameList,it.polimi.ingsw.controller.Interfaces.MalevolentPlayerManager)">
<h3>GameController</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">GameController</span><wbr><span class="parameters">(<a href="../model/tableReleted/Game.html" title="class in it.polimi.ingsw.model.tableReleted">Game</a>&nbsp;game,
 <a href="../model/cardReleted/cards/CardTable.html" title="class in it.polimi.ingsw.model.cardReleted.cards">CardTable</a>&nbsp;cardTable,
 <a href="persistence/PersistenceFactory.html" title="class in it.polimi.ingsw.controller.persistence">PersistenceFactory</a>&nbsp;persistenceFactory,
 <a href="Interfaces/GameList.html" title="interface in it.polimi.ingsw.controller.Interfaces">GameList</a>&nbsp;gameList,
 <a href="Interfaces/MalevolentPlayerManager.html" title="interface in it.polimi.ingsw.controller.Interfaces">MalevolentPlayerManager</a>&nbsp;malevolentPlayerManager)</span></div>
<div class="block">The constructor of the class GameController creates a new GameController object</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>game</code> - the game object managed by this class containing the game state and the players' data</dd>
<dd><code>cardTable</code> - the cardTable object used to map the cards' ids to the corresponding cards objects</dd>
<dd><code>persistenceFactory</code> - the class responsible for managing the persistence property, used to save periodically the game</dd>
<dd><code>gameList</code> - the class that manages the game list, used to remove the game if it ends</dd>
<dd><code>malevolentPlayerManager</code> - the class that manage the consequences of the malevolent players</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getPlayerViewMap()">
<h3>getPlayerViewMap</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="../view/ViewInterface.html" title="interface in it.polimi.ingsw.view">ViewInterface</a>&gt;</span>&nbsp;<span class="element-name">getPlayerViewMap</span>()</div>
<div class="block">Method used to get the active players map containing
 their nicknames and the corresponding view objects</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the active players map</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getGamePlayers()">
<h3>getGamePlayers</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</span>&nbsp;<span class="element-name">getGamePlayers</span>()</div>
<div class="block">Method used to get the list of nicknames of the players that are part of the game,
 i.e. the players that can join the game</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the list of nicknames of the players that are part of the game</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="join(java.lang.String,it.polimi.ingsw.view.ViewInterface,boolean)">
<h3>join</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">join</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;joinerNickname,
 <a href="../view/ViewInterface.html" title="interface in it.polimi.ingsw.view">ViewInterface</a>&nbsp;view,
 boolean&nbsp;reconnected)</span></div>
<div class="block">Method used to join the game managed by this controller
 if the player joining is no more part of the game, the player is moved to the login form
 else it logs the join event on the server, saves the game state, updates the model,
 updates the view of the joining player with the data corresponding with the current phase
 of the game, and notifies the other players of the join event
 If the player joining is the only player in the game, it starts the last player in game timer
 Logs the event on the server</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>joinerNickname</code> - the nickname of the player joining the game</dd>
<dd><code>view</code> - the view object of the player joining the game</dd>
<dd><code>reconnected</code> - a boolean value that is true if the player is reconnected to the game,
                    false if is connecting for the first time</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="choosePawn(java.lang.String,it.polimi.ingsw.model.playerReleted.PawnColors)">
<h3>choosePawn</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">choosePawn</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname,
 <a href="../model/playerReleted/PawnColors.html" title="enum class in it.polimi.ingsw.model.playerReleted">PawnColors</a>&nbsp;color)</span></div>
<div class="block">Method used by the user to choose its pawn color
 If the chosen color is not available, the player is notified and the prompted to re-choose a color
 If the player is not in the correct state to choose a pawn,
 the player the malevolent consequences are triggered
 If the player chooses the black pawn, the player is marked as malevolent
 Otherwise the model is updated with the chosen color, the player is moved to the wait state,
 waiting for the other players to choose their pawn and game is saved on disk
 Logs the event on the server
 The chooser view and the other players are notified of the choice
 If all the players have chosen their pawn, the game moves to the secret objective phase</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Interfaces/GameControllerInterface.html#choosePawn(java.lang.String,it.polimi.ingsw.model.playerReleted.PawnColors)">choosePawn</a></code>&nbsp;in interface&nbsp;<code><a href="Interfaces/GameControllerInterface.html" title="interface in it.polimi.ingsw.controller.Interfaces">GameControllerInterface</a></code></dd>
<dt>Parameters:</dt>
<dd><code>nickname</code> - the nickname of the player choosing the pawn color</dd>
<dd><code>color</code> - the pawn color chosen by the player</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="chooseSecretObjective(java.lang.String,it.polimi.ingsw.lightModel.lightPlayerRelated.LightCard)">
<h3>chooseSecretObjective</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">chooseSecretObjective</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname,
 <a href="../lightModel/lightPlayerRelated/LightCard.html" title="class in it.polimi.ingsw.lightModel.lightPlayerRelated">LightCard</a>&nbsp;lightObjChoice)</span></div>
<div class="block">Method used to choose the secret objective card of the player
 If the chosen card is not valid or the player isn't in the correct state,
 the player is marked as malevolent
 Otherwise the model is updated with the chosen card, the player is moved to the wait state,
 the player choosing it is notified of the choice and its view updated,
 and the other players are notified of the choice
 If all the players have chosen their secret objective,
 the game moves to the actual game phase and the game is saved on disk
 Logs the event on the server</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Interfaces/GameControllerInterface.html#chooseSecretObjective(java.lang.String,it.polimi.ingsw.lightModel.lightPlayerRelated.LightCard)">chooseSecretObjective</a></code>&nbsp;in interface&nbsp;<code><a href="Interfaces/GameControllerInterface.html" title="interface in it.polimi.ingsw.controller.Interfaces">GameControllerInterface</a></code></dd>
<dt>Parameters:</dt>
<dd><code>nickname</code> - the nickname of the player choosing the secret objective card</dd>
<dd><code>lightObjChoice</code> - the secret objective card chosen by the player</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="place(java.lang.String,it.polimi.ingsw.lightModel.lightPlayerRelated.LightPlacement)">
<h3>place</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">place</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname,
 <a href="../lightModel/lightPlayerRelated/LightPlacement.html" title="class in it.polimi.ingsw.lightModel.lightPlayerRelated">LightPlacement</a>&nbsp;placement)</span></div>
<div class="block">Method used to place the start card or the other card in hand by the player
 If the card placed is not valid or its position isn't in the frontier the player is marked as malevolent
 Otherwise it recognizes if the card placed is the start card or another card in hand and calls
 the corresponding method to place the card
 Logs the event on the server</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Interfaces/GameControllerInterface.html#place(java.lang.String,it.polimi.ingsw.lightModel.lightPlayerRelated.LightPlacement)">place</a></code>&nbsp;in interface&nbsp;<code><a href="Interfaces/GameControllerInterface.html" title="interface in it.polimi.ingsw.controller.Interfaces">GameControllerInterface</a></code></dd>
<dt>Parameters:</dt>
<dd><code>nickname</code> - the nickname of the player placing the card</dd>
<dd><code>placement</code> - the placement of the card in the player codex,
                  specifying the card placed, its position
                  and the face shawn</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="draw(java.lang.String,it.polimi.ingsw.model.cardReleted.utilityEnums.DrawableCard,int)">
<h3>draw</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">draw</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname,
 <a href="../model/cardReleted/utilityEnums/DrawableCard.html" title="enum class in it.polimi.ingsw.model.cardReleted.utilityEnums">DrawableCard</a>&nbsp;deckType,
 int&nbsp;cardID)</span></div>
<div class="block">Method used to draw a card from the specified deck in the specified position
 If the player isn't in the correct state to draw the card, the player is marked as malevolent
 If deck are not empty and the card is drawn, the model is updated with the drawn card,
 and the view is updated accordingly with the drawn card in hand and the decks
 After the draw the game moves on to the next player turn,
 it checks if the ending conditions are met and if so moves to the last turns phase
 It save the game state on disk
 Logs the event on the server</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Interfaces/GameControllerInterface.html#draw(java.lang.String,it.polimi.ingsw.model.cardReleted.utilityEnums.DrawableCard,int)">draw</a></code>&nbsp;in interface&nbsp;<code><a href="Interfaces/GameControllerInterface.html" title="interface in it.polimi.ingsw.controller.Interfaces">GameControllerInterface</a></code></dd>
<dt>Parameters:</dt>
<dd><code>nickname</code> - the nickname of the player drawing the card</dd>
<dd><code>deckType</code> - the deck from which the card is drawn (either Resource or Gold)</dd>
<dd><code>cardID</code> - the position of the card to draw (0,1 for the buffer, 2 for the deck)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="leave(java.lang.String)">
<h3>leave</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">leave</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;nickname)</span></div>
<div class="block">Method used by the player to leave the game managed by this controller
 The player is removed from the active players map, and the leave is notified to the other players views
 The view of the leaver is erased
 If the player is leaving while the game is in setup (choose start card, choose pawn, choose secret objective),
 the player leaving hasn't chosen yet while the other players have, the game moves on to the next phase
 If the player is leaving during its turn the game turns moves on,
 if the player should draw a card, the card is randomly drawn and the game moves on to the next player turn
 If after the player leaves it remains only one player in the game, the last player in game timer is started
 If the game is in the end game phase and the last player leaves, the game is deleted from the game list and from disk
 If all the players leaves while the game isn't in the end game phase,
 the game is saved and stored until reconnection or expiration defined by the gameSaveExpirationTimeMinutes</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>nickname</code> - the nickname of the player leaving the game</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getWinners()">
<h3>getWinners</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</span>&nbsp;<span class="element-name">getWinners</span>()</div>
<div class="block">It calculates the player(s) with the max amount of points,
 if there is only one player with the max amount of points it declares it as the winner,
 otherwise it calculates the number of objective cards completed by the player(s) with the max amount of points
 if there is only one player with the max amount of objective cards completed it declares it as the winner,
 otherwise it declares all the players with the max amount of points and objective cards completed as the winners</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a List containing the winner(s) of the game</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="updateJoinActualGame(java.lang.String,it.polimi.ingsw.model.tableReleted.Game)">
<h3>updateJoinActualGame</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">updateJoinActualGame</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;joiner,
 <a href="../model/tableReleted/Game.html" title="class in it.polimi.ingsw.model.tableReleted">Game</a>&nbsp;game)</span></div>
<div class="block">Method used to update the lightModel of the user joining during the actualGame phase
 with the data of the game
 The active and inactive players are updated, the placement history is updated,
 the hand of the player is updated, the back of the hand of the other players is updated,
 the deck status is updated and the current player turn is updated</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>joiner</code> - the nickname of the player that has joined the game</dd>
<dd><code>game</code> - the game to which the player has joined</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="sendChatMessage(it.polimi.ingsw.model.playerReleted.ChatMessage)">
<h3>sendChatMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">sendChatMessage</span><wbr><span class="parameters">(<a href="../model/playerReleted/ChatMessage.html" title="class in it.polimi.ingsw.model.playerReleted">ChatMessage</a>&nbsp;chatMessage)</span></div>
<div class="block">Method used to send a chat message to the game
 checks if the message is empty, if the receiver is empty or not in the game
 if not it sends the message to the receiver
 updating all the players lightChat if the message is public
 or only the sender and the receiver lightChat if the message is private</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>chatMessage</code> - the chat message sent by the player</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
